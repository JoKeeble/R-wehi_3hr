---
layout: topic
title: Starting with data
author: Data Carpentry contributors
minutes: 20
---

```{r, echo=FALSE, purl=FALSE, message = FALSE}
source("setup_wehi.R")
```

------------

> ## Learning Objectives
>
> * Build an understanding of the concepts of a `data.frame`
> * Understand how to load external data (CSV files) in memory using
>  (`cytokines.csv`) as an example
> * Explore the structure and the content of the data in R
> * Understand what are factors and how to manipulate them

------------
# Data Frames

`data.frame` is the _de facto_ data structure for most tabular data and what we
use for statistics and plotting.

A `data.frame` is a collection of vectors of identical lengths. Each vector
represents a column, and each vector can be of a different data type (e.g.,
characters, integers, factors). The `str()` function is useful to inspect the
data types of the columns.

A `data.frame` can be created by the functions `read.csv()` or `read.table()`.

By default, `data.frame` converts (= coerces) columns that contain characters
(i.e., text) into the `factor` data type. Depending on what you want to do with
the data, you may want to keep these columns as `character`. To do so,
`read.csv()` and `read.table()` have an argument called `stringsAsFactors` which
can be set to `FALSE`:

```{r, eval=FALSE, purl=FALSE}
some_data <- read.csv("data/some_file.csv", stringsAsFactors=FALSE)
```


# Presentation of Cytokine Data

```{r, echo=FALSE, purl=TRUE}
### Presentation of cytokine data
```

Cytokine levels were measured in serum collected from "control", "infection_A", and "infection_B" patients.
The dataset is stored as a `csv` file: each row holds information for a single patient, and the columns represent:

| Column           | Description                        |
|------------------|------------------------------------|
| patient_id       | unique id for each patient         |
| group            | status of patient                  |
| IL17F            | concentration of IL17F             |
| IL17A            | concentration of IL17A             |
| GMCSF            | concentration of GMCSF             |
| IL2              | concentration of IL2               |
| CXCL9            | concentration of CXCL9             |
| CXCL10           | concentration of CXCL10            |
| ENA78            | concentration of ENA78             |
| IL4              | concentration of IL4               |


Use the R function `download.file()` to download the CSV file
that contains the cytokine data from figshare, and use `read.csv()` to
load into memory (as a `data.frame`) the content of the CSV file:

- First, make sure you are in the correct working directory by typing `getwd()`.
- Second, create a new directory within this working directory called `data`. You
can do this by clicking on the new folder icon in RStudio under the file tab, or
by typing `dir.create("data")` at the terminal.
- Third, download the data:

```{r, eval=FALSE, purl=TRUE}
download.file("http://figshare.com/articles/WEHI_R_Demo/1604914",
              "data/cytokines.csv")
```

You are now ready to load the data:

```{r, eval=TRUE,  purl=FALSE}
cytokines <- read.csv('data/cytokines.csv')
```

This statement doesn't produce any output because assignment doesn't display
anything. If we want to check that our data has been loaded, we can print the
variable's value: `cytokines`

Alternatively, wrapping an assignment in parentheses will perform the assignment
and display it at the same time.

```{r, eval = TRUE, purl = FALSE}
(cytokines <- read.csv('data/cytokines.csv'))
```

Check the top (the first 6 lines) of this `data.frame` using the
function `head()`:

```{r, results='show', purl=FALSE}
head(cytokines)
```

Let's now check the __str__ucture of this `data.frame` in more details with the
function `str()`:

```{r, purl=FALSE}
str(cytokines)
```

### Challenge

Based on the output of `str(cytokines)`,

* What is the class of the object `cytokines`?
* How many rows and how many columns are in this object?
* How many patient groups have been tested?

```{r, echo=FALSE, purl=TRUE}

## Challenge
## Based on the output of `str(cytokines)`, 

## * What is the class of the object `cytokines`?
## * How many rows and how many columns are in this object?
## * How many patient groups have been tested?

```



## Factors

```{r, echo=FALSE, purl=TRUE}
### Factors
```

Factors are used to represent categorical data. Factors can be ordered or
unordered and are an important class for statistical analysis and for plotting.

Factors contain a pre-defined set values, known as *levels*. By default, R always sorts *levels* in alphabetical order. It will assign `1` to the first level, `2` to the next, and so on. Let's look at our cytokine dataset:

```{r, purl=TRUE}
str(cytokines)
cytokines$group
levels(cytokines$group)    # names of unique levels within our 'group' column
nlevels(cytokines$group)   # number of unique levels 
```

### Converting factors 

If you need to convert a factor to a character vector, simply use
`as.character(x)`. For example:

```{r, purl=TRUE}
cytokines$group <- as.character(cytokines$group)
str(cytokines)
```

Now convert it back to a factor:
```{r, purl=TRUE}
cytokines$group <- as.factor(cytokines$group)
str(cytokines)
```